{% load static %}

<!-- ğŸ”§ æ–‡ç« æ’åº -->
<form method="get" class="d-flex align-items-center mb-3">
    <label class="me-2 text-muted fw-bold">æ’åºæ–¹å¼ï¼š</label>

    <select name="sort" class="form-select form-select-sm w-auto"
            onchange="this.form.submit()">
        <option value="created_at" {% if sort == 'created_at' %}selected{% endif %}>
            æœ€æ–°å‘å¸ƒ
        </option>
        <option value="views" {% if sort == 'views' %}selected{% endif %}>
            æµè§ˆæœ€å¤š
        </option>
        <option value="likes" {% if sort == 'likes' %}selected{% endif %}>
            ç‚¹èµæœ€å¤š
        </option>
    </select>

    {% if request.GET.page %}
        <input type="hidden" name="page" value="{{ request.GET.page }}">
    {% endif %}
</form>

<!-- ğŸ”§ æ–‡ç« åˆ—è¡¨ -->
<div class="list-group">
    {% for article in articles %}
        <a href="{% url 'articles:article_detail' article.slug %}" class="list-group-item list-group-item-action mb-2 shadow-sm rounded">
            <div class="d-flex justify-content-between align-items-center">
                <h5 class="mb-1">{{ article.title }}</h5>
                <small class="text-muted">
                    ğŸ“… {{ article.created_at|date:"Y-m-d H:i" }}
                </small>
            </div>
            <p class="mb-1 text-secondary small">
                {{ article.excerpt|truncatewords:25 }}
            </p>
            <div class="d-flex justify-content-end gap-3 small text-muted">
                <span>ğŸ‘ {{ article.views }}</span>
                <span>â¤ï¸ {{ article.likes }}</span>
            </div>
        </a>
    {% empty %}
        <p class="text-muted text-center">è¿˜æ²¡æœ‰å‘è¡¨ä»»ä½•æ–‡ç« ã€‚</p>
    {% endfor %}
</div>

<!-- ğŸ”§ åˆ†é¡µå¯¼èˆª -->
{% if articles.paginator.num_pages > 1 %}
<nav class="mt-4">
    <ul class="pagination justify-content-center pagination-sm">

        {% if articles.has_previous %}
            <li class="page-item">
                <a class="page-link"
                   href="?page={{ articles.previous_page_number }}&sort={{ sort }}">
                    ä¸Šä¸€é¡µ
                </a>
            </li>
        {% endif %}

        <li class="page-item active">
            <span class="page-link">
                ç¬¬ {{ articles.number }} / {{ articles.paginator.num_pages }} é¡µ
            </span>
        </li>

        {% if articles.has_next %}
            <li class="page-item">
                <a class="page-link"
                   href="?page={{ articles.next_page_number }}&sort={{ sort }}">
                    ä¸‹ä¸€é¡µ
                </a>
            </li>
        {% endif %}
    </ul>
</nav>
{% endif %}
